pipeline {
    agent any
    parameters {
        string(defaultValue: 'bluesky-step-functions', description: 'S3Bucket Name', name: 'S3Bucket')
		string(defaultValue: '/bluesky-step-functions/Step-Functions-Latest', description: 'Folder Path', name: 'S3key')
        string(defaultValue: '/bluesky-step-functions/Lambda-Functions-Latest', description: 'Folder Path', name: 'S3key')
    }

    stages {
        stage ('ZipFileCreation'){
            steps{
                sh '''
                    cd data-analytics
		    rm -rf data_analytics_RDS_snapshot-1.zip
                    zip data_analytics_RDS_snapshot-1.zip test.py
		    zip -ur data_analytics_RDS_snapshot-1.zip pgysog
					
					
                '''
            }
        }
       
       stage("Publish to S3") {
					steps {
						s3Upload(bucket:"cf-templates-1nm8d7zv1298-ap-northeast-1", path:'test/', includePathPattern:"data_analytics_RDS_snapshot-1.zip", workingDir:"${env.WORKSPACE}/data-analytics")
						echo "Published zip to S3 "
					}
				}
		
		
    }
	post {
         success {  
             echo 'The Integration pipeline ran successfully. Triggering email.'
         }  
         failure {  
             echo 'The pipeline failed.'
         }		 
		}

}
